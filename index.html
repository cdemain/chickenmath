<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🐔 Backyard Eggstravaganza Calculator 🥚</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&family=Chicken+Pie&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Chicken Pie', 'Poppins', Arial, sans-serif;
            margin: 20px;
            transition: background-color 0.3s, color 0.3s;
            background-image: url('https://www.transparenttextures.com/patterns/paper-fibers.png');
            background-color: #fff7d1; /* Egg yolk light */
            color: #4a2c0a; /* Hen brown */
            overflow-x: hidden;
        }
        .dark-mode {
            background-color: #1a0f03; /* Midnight coop */
            color: #fff7d1;
        }
        .section {
            margin-bottom: 20px;
            background: rgba(255, 230, 153, 0.9); /* Sunny yolk */
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            border: 3px dashed #e67300; /* Orange beak */
            position: relative;
        }
        .dark-mode .section {
            background: rgba(74, 44, 10, 0.9); /* Dark coop wood */
            border-color: #ff9900; /* Glowing beak */
        }
        .chicken-entry {
            border: 3px solid #ff9900; /* Bright beak */
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 10px;
            background: #fff0b3; /* Pale egg */
            position: relative;
        }
        .dark-mode .chicken-entry {
            border-color: #e67300;
            background: #3f2606;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background-color: #ff9900; /* Beak orange */
            color: #fff7d1;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.3s;
            font-size: 18px;
            font-weight: bold;
            text-transform: uppercase;
        }
        button:hover {
            background-color: #ffcc00; /* Yolk pop */
            transform: scale(1.1);
        }
        .dark-mode button {
            background-color: #e67300;
        }
        .dark-mode button:hover {
            background-color: #ff9900;
        }
        label {
            display: inline-block;
            width: 240px;
            font-weight: bold;
            color: #8c5523; /* Coop brown */
            font-family: 'Poppins', Arial, sans-serif; /* Cleaner font for labels */
        }
        .dark-mode label {
            color: #ffcc00;
        }
        input, select {
            margin-bottom: 15px;
            padding: 8px;
            border-radius: 8px;
            border: 2px solid #ff9900;
            background: #fff7d1;
            font-size: 16px;
            font-family: 'Poppins', Arial, sans-serif;
        }
        .dark-mode input, .dark-mode select {
            border-color: #e67300;
            background: #3f2606;
            color: #fff7d1;
        }
        h1 {
            color: #e67300;
            text-align: center;
            font-size: 40px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
            margin-bottom: 30px;
        }
        .dark-mode h1 {
            color: #ffcc00;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
        }
        h2 {
            color: #ff9900;
            font-size: 28px;
            margin-top: 0;
            display: inline-block;
        }
        .dark-mode h2 {
            color: #ffcc00;
        }
        h3 {
            color: #8c5523;
            font-size: 22px;
        }
        .dark-mode h3 {
            color: #fff7d1;
        }
        #themeToggle {
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1000;
        }
        .chicken-emoji {
            font-size: 28px;
            margin: 0 8px;
            animation: peck 1s infinite;
        }
        .egg-emoji {
            font-size: 24px;
            margin: 0 8px;
            animation: wobble 2s infinite;
        }
        @keyframes peck {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(15deg); }
        }
        @keyframes wobble {
            0%, 100% { transform: translateY(0); }
            25% { transform: translateY(-5px); }
            75% { transform: translateY(5px); }
        }
        .coop-header::before {
            content: "🐓";
            font-size: 32px;
            position: absolute;
            top: -25px;
            left: 10px;
            animation: strut 3s infinite;
        }
        .coop-header::after {
            content: "🥚";
            font-size: 28px;
            position: absolute;
            top: -20px;
            right: 10px;
            animation: roll 2s infinite;
        }
        @keyframes strut {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }
        @keyframes roll {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <button id="themeToggle" onclick="toggleTheme()">🐾 Dark Mode 🌙</button>
    <h1>🐔 Backyard Eggstravaganza Calculator 🥚</h1>

    <!-- Initial Setup Costs -->
    <div class="section">
        <h2 class="coop-header">🐣 Initial Setup Costs 🏡</h2>
        <label>Initial Investment ($ over flock lifespan):</label>
        <input type="number" id="initialCost" value="3000" min="0" step="10"><br>
    </div>

    <!-- Chicken Details -->
    <div class="section">
        <h2 class="coop-header">🐓 Chickens 🐓</h2>
        <label>Number of Chickens:</label>
        <input type="number" id="chickenCount" min="1" value="1" onchange="updateChickenInputs()"><br>
        <label>Egg Production Unit:</label>
        <select id="eggUnit" onchange="updateChickenInputs()">
            <option value="year">Per Year</option>
            <option value="week">Per Week</option>
        </select><br>
        <div id="chickenInputs"></div>
    </div>

    <!-- Ongoing Expenses -->
    <div class="section">
        <h2 class="coop-header">🌾 Ongoing Expenses 🌽</h2>
        <label>Feed Cost <span class="egg-emoji">🌾</span>:</label>
        <input type="number" id="feedCost" min="0" value="0">
        <select id="feedUnit">
            <option value="week">Per Week</option>
            <option value="month">Per Month</option>
            <option value="year">Per Year</option>
        </select><br>
        <label>Gravel Cost <span class="egg-emoji">🪨</span>:</label>
        <input type="number" id="gravelCost" min="0" value="0">
        <select id="gravelUnit">
            <option value="week">Per Week</option>
            <option value="month">Per Month</option>
            <option value="year">Per Year</option>
        </select><br>
        <label>Oyster Shell Cost <span class="egg-emoji">🐚</span>:</label>
        <input type="number" id="oysterShellCost" min="0" value="0">
        <select id="oysterShellUnit">
            <option value="week">Per Week</option>
            <option value="month">Per Month</option>
            <option value="year">Per Year</option>
        </select><br>
        <label>Nesting Box Pads Cost <span class="egg-emoji">🛏️</span>:</label>
        <input type="number" id="nestingCost" min="0" value="0">
        <select id="nestingUnit">
            <option value="week">Per Week</option>
            <option value="month">Per Month</option>
            <option value="year">Per Year</option>
        </select><br>
        <label>Coop Lining Cost <span class="egg-emoji">🏠</span>:</label>
        <input type="number" id="coopLiningCost" min="0" value="0">
        <select id="coopLiningUnit">
            <option value="week">Per Week</option>
            <option value="month">Per Month</option>
            <option value="year">Per Year</option>
        </select>
    </div>

    <!-- Sale Incidentals -->
    <div class="section">
        <h2 class="coop-header">📦 Sale Incidentals 🥚</h2>
        <label>Egg Carton Cost <span class="egg-emoji">📦</span>:</label>
        <input type="number" id="cartonCost" min="0" value="0">
        <select id="cartonUnit">
            <option value="perCarton">Per Carton</option>
            <option value="per10">Per 10 Cartons</option>
            <option value="per100">Per 100 Cartons</option>
        </select><br>
        <label>Stamp/Ink Cost <span class="egg-emoji">✒️</span>:</label>
        <input type="number" id="stampCost" min="0" value="0">
        <select id="stampUnit">
            <option value="perCarton">Per Carton</option>
            <option value="per10">Per 10 Cartons</option>
            <option value="per100">Per 100 Cartons</option>
        </select>
    </div>

    <!-- Profit Margin -->
    <div class="section">
        <h2 class="coop-header">💰 Profit Margin 🤑</h2>
        <label>Desired Profit Margin (%):</label>
        <input type="number" id="profitMargin" min="0" value="19" step="0.1">
    </div>

    <!-- Buttons -->
    <button onclick="calculatePrice()">🐔 Calculate Cluckin' Price! 🥚</button>
    <button onclick="saveData()">💾 Save Coop Data 🐓</button>
    <button onclick="loadData()">📂 Load Coop Data 🐔</button>

    <!-- Result -->
    <div class="section">
        <h2 class="coop-header">🎉 Result 🥚</h2>
        <p>Selling Price per Dozen: <span id="result" class="chicken-emoji">$0.00</span> <span class="egg-emoji">💰</span></p>
    </div>

    <script>
        const breedData = {
            "Leghorn (White)": { eggsPerYear: 300, lifespan: 4.5 },
            "Rhode Island Red": { eggsPerYear: 275, lifespan: 6.0 },
            "Plymouth Rock (Barred)": { eggsPerYear: 225, lifespan: 5.5 },
            "Australorp": { eggsPerYear: 275, lifespan: 6.0 },
            "Orpington (Buff)": { eggsPerYear: 190, lifespan: 5.5 },
            "Sussex (Light)": { eggsPerYear: 260, lifespan: 5.5 },
            "Wyandotte": { eggsPerYear: 220, lifespan: 5.5 },
            "Ameraucana": { eggsPerYear: 225, lifespan: 6.0 },
            "Golden Comet": { eggsPerYear: 275, lifespan: 3.5 },
            "Isa Brown": { eggsPerYear: 325, lifespan: 3.5 },
            "Custom Breed": { eggsPerYear: 250, lifespan: 4.0 }
        };

        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const button = document.getElementById('themeToggle');
            button.textContent = document.body.classList.contains('dark-mode') ? 
                '🐣 Light Mode ☀️' : '🐾 Dark Mode 🌙';
            localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
        }

        function updateChickenInputs() {
            const count = parseInt(document.getElementById('chickenCount').value) || 1;
            const eggUnit = document.getElementById('eggUnit').value;
            const container = document.getElementById('chickenInputs');
            container.innerHTML = '';
            for (let i = 0; i < count; i++) {
                const breedOptions = Object.keys(breedData).map(breed => 
                    `<option value="${breed}">${breed}</option>`).join('');
                const defaultRate = eggUnit === 'year' ? breedData['Leghorn (White)'].eggsPerYear : 
                                    breedData['Leghorn (White)'].eggsPerYear / 52;
                container.innerHTML += `
                    <div class="chicken-entry">
                        <h3>Chicken ${i + 1} <span class="chicken-emoji">🐔</span></h3>
                        <label>Name (optional) <span class="egg-emoji">🐣</span>:</label>
                        <input type="text" id="name${i}" placeholder="e.g., Clucky"><br>
                        <label>Breed <span class="chicken-emoji">🐓</span>:</label>
                        <select id="breed${i}" onchange="updateBreedDefaults(${i})">${breedOptions}</select><br>
                        <div id="customBreed${i}" style="display: none;">
                            <label>Custom Breed Name <span class="egg-emoji">🥚</span>:</label>
                            <input type="text" id="customBreedName${i}"><br>
                        </div>
                        <label>Cost ($ over lifespan) <span class="egg-emoji">💸</span>:</label>
                        <input type="number" id="cost${i}" min="0" value="0"><br>
                        <label>Egg Production Rate (${eggUnit}) <span class="egg-emoji">🥚</span>:</label>
                        <input type="number" id="rate${i}" min="0" step="${eggUnit === 'year' ? 1 : 0.1}" value="${defaultRate}"><br>
                        <label>Productive Lifespan (years) <span class="chicken-emoji">⏳</span>:</label>
                        <input type="number" id="lifespan${i}" min="0.1" step="0.1" value="${breedData['Leghorn (White)'].lifespan}">
                    </div>
                `;
                updateBreedDefaults(i);
            }
        }

        function updateBreedDefaults(index) {
            const breed = document.getElementById(`breed${index}`).value;
            const eggUnit = document.getElementById('eggUnit').value;
            const customDiv = document.getElementById(`customBreed${index}`);
            const rateInput = document.getElementById(`rate${index}`);
            const lifespanInput = document.getElementById(`lifespan${index}`);
            if (breed === "Custom Breed") {
                customDiv.style.display = "block";
                rateInput.value = eggUnit === 'year' ? breedData[breed].eggsPerYear : 
                                  breedData[breed].eggsPerYear / 52;
            } else {
                customDiv.style.display = "none";
                rateInput.value = eggUnit === 'year' ? breedData[breed].eggsPerYear : 
                                  breedData[breed].eggsPerYear / 52;
            }
            lifespanInput.value = breedData[breed].lifespan;
        }

        function calculatePrice() {
            const initialCost = parseFloat(document.getElementById('initialCost').value) || 0;
            const chickenCount = parseInt(document.getElementById('chickenCount').value) || 1;
            const eggUnit = document.getElementById('eggUnit').value;
            let totalEggsPerWeek = 0;
            let maxLifespan = 0;
            const chickenEggsOverLifespan = [];

            for (let i = 0; i < chickenCount; i++) {
                const cost = parseFloat(document.getElementById(`cost${i}`).value) || 0;
                let rate = parseFloat(document.getElementById(`rate${i}`).value) || 0;
                const lifespan = parseFloat(document.getElementById(`lifespan${i}`).value) || 0;
                rate = eggUnit === 'year' ? rate / 52 : rate;
                totalEggsPerWeek += rate;
                maxLifespan = Math.max(maxLifespan, lifespan);
                chickenEggsOverLifespan.push(rate * 52 * lifespan);
            }

            const totalEggsFlockLifespan = totalEggsPerWeek * 52 * maxLifespan;
            const initialCostPerEgg = totalEggsFlockLifespan > 0 ? initialCost / totalEggsFlockLifespan : 0;
            const chickenCostPerEgg = chickenEggsOverLifespan.reduce((sum, eggs, i) => 
                sum + (eggs > 0 ? document.getElementById(`cost${i}`).value / eggs : 0), 0);

            const feedCost = convertToWeekly('feedCost', 'feedUnit');
            const gravelCost = convertToWeekly('gravelCost', 'gravelUnit');
            const oysterShellCost = convertToWeekly('oysterShellCost', 'oysterShellUnit');
            const nestingCost = convertToWeekly('nestingCost', 'nestingUnit');
            const coopLiningCost = convertToWeekly('coopLiningCost', 'coopLiningUnit');
            const totalOngoingWeekly = feedCost + gravelCost + oysterShellCost + nestingCost + coopLiningCost;
            const ongoingCostPerEgg = totalEggsPerWeek > 0 ? totalOngoingWeekly / totalEggsPerWeek : 0;

            const cartonCost = convertCartonCost('cartonCost', 'cartonUnit');
            const stampCost = convertCartonCost('stampCost', 'stampUnit');
            const incidentalCostPerEgg = (cartonCost + stampCost) / 12;

            const totalCostPerEgg = initialCostPerEgg + chickenCostPerEgg + ongoingCostPerEgg + incidentalCostPerEgg;
            const costPerDozen = totalCostPerEgg * 12;
            const profitMargin = (parseFloat(document.getElementById('profitMargin').value) || 19) / 100;
            const sellingPricePerDozen = costPerDozen * (1 + profitMargin);

            document.getElementById('result').textContent = `$${sellingPricePerDozen.toFixed(2)}`;
        }

        function convertToWeekly(costId, unitId) {
            const cost = parseFloat(document.getElementById(costId).value) || 0;
            const unit = document.getElementById(unitId).value;
            if (unit === 'month') return cost / 4.33;
            if (unit === 'year') return cost / 52;
            return cost;
        }

        function convertCartonCost(costId, unitId) {
            const cost = parseFloat(document.getElementById(costId).value) || 0;
            const unit = document.getElementById(unitId).value;
            if (unit === 'per10') return cost / 10;
            if (unit === 'per100') return cost / 100;
            return cost;
        }

        function saveData() {
            const data = {
                initialCost: document.getElementById('initialCost').value,
                chickenCount: document.getElementById('chickenCount').value,
                eggUnit: document.getElementById('eggUnit').value,
                chickens: Array.from({ length: parseInt(document.getElementById('chickenCount').value) }, (_, i) => ({
                    name: document.getElementById(`name${i}`).value,
                    breed: document.getElementById(`breed${i}`).value,
                    customBreedName: document.getElementById(`breed${i}`).value === "Custom Breed" ? 
                        document.getElementById(`customBreedName${i}`).value : "",
                    cost: document.getElementById(`cost${i}`).value,
                    rate: document.getElementById(`rate${i}`).value,
                    lifespan: document.getElementById(`lifespan${i}`).value
                })),
                feedCost: document.getElementById('feedCost').value,
                feedUnit: document.getElementById('feedUnit').value,
                gravelCost: document.getElementById('gravelCost').value,
                gravelUnit: document.getElementById('gravelUnit').value,
                oysterShellCost: document.getElementById('oysterShellCost').value,
                oysterShellUnit: document.getElementById('oysterShellUnit').value,
                nestingCost: document.getElementById('nestingCost').value,
                nestingUnit: document.getElementById('nestingUnit').value,
                coopLiningCost: document.getElementById('coopLiningCost').value,
                coopLiningUnit: document.getElementById('coopLiningUnit').value,
                cartonCost: document.getElementById('cartonCost').value,
                cartonUnit: document.getElementById('cartonUnit').value,
                stampCost: document.getElementById('stampCost').value,
                stampUnit: document.getElementById('stampUnit').value,
                profitMargin: document.getElementById('profitMargin').value
            };
            localStorage.setItem('eggCalculatorData', JSON.stringify(data));
            alert('🐓 Coop Data Saved! 🥚');
        }

        function loadData() {
            const data = JSON.parse(localStorage.getItem('eggCalculatorData') || '{}');
            if (Object.keys(data).length === 0) return;

            document.getElementById('initialCost').value = data.initialCost || 3000;
            document.getElementById('chickenCount').value = data.chickenCount || 1;
            document.getElementById('eggUnit').value = data.eggUnit || 'year';
            updateChickenInputs();
            data.chickens?.forEach((chicken, i) => {
                document.getElementById(`name${i}`).value = chicken.name || '';
                document.getElementById(`breed${i}`).value = chicken.breed || 'Leghorn (White)';
                if (chicken.breed === "Custom Breed") {
                    document.getElementById(`customBreedName${i}`).value = chicken.customBreedName || '';
                }
                document.getElementById(`cost${i}`).value = chicken.cost || 0;
                document.getElementById(`rate${i}`).value = chicken.rate || 
                    (data.eggUnit === 'year' ? breedData[chicken.breed || 'Leghorn (White)'].eggsPerYear : 
                    breedData[chicken.breed || 'Leghorn (White)'].eggsPerYear / 52);
                document.getElementById(`lifespan${i}`).value = chicken.lifespan || 
                    breedData[chicken.breed || 'Leghorn (White)'].lifespan;
                updateBreedDefaults(i);
            });
            document.getElementById('feedCost').value = data.feedCost || 0;
            document.getElementById('feedUnit').value = data.feedUnit || 'week';
            document.getElementById('gravelCost').value = data.gravelCost || 0;
            document.getElementById('gravelUnit').value = data.gravelUnit || 'week';
            document.getElementById('oysterShellCost').value = data.oysterShellCost || 0;
            document.getElementById('oysterShellUnit').value = data.oysterShellUnit || 'week';
            document.getElementById('nestingCost').value = data.nestingCost || 0;
            document.getElementById('nestingUnit').value = data.nestingUnit || 'week';
            document.getElementById('coopLiningCost').value = data.coopLiningCost || 0;
            document.getElementById('coopLiningUnit').value = data.coopLiningUnit || 'week';
            document.getElementById('cartonCost').value = data.cartonCost || 0;
            document.getElementById('cartonUnit').value = data.cartonUnit || 'perCarton';
            document.getElementById('stampCost').value = data.stampCost || 0;
            document.getElementById('stampUnit').value = data.stampUnit || 'perCarton';
            document.getElementById('profitMargin').value = data.profitMargin || 19;
        }

        // Initialize
        window.onload = () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.body.classList.add('dark-mode');
                document.getElementById('themeToggle').textContent = '🐣 Light Mode ☀️';
            }
            loadData();
            updateChickenInputs();
        };
    </script>
</body>
</html>
